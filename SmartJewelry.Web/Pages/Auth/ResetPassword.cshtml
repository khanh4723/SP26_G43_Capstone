@page
@model SmartJewelry.Web.Pages.Auth.ResetPasswordModel
@{
    ViewData["Title"] = "Đặt lại mật khẩu";
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"] - Smart Jewelry</title>
    <link rel="stylesheet" href="~/css/auth.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

<div class="auth-wrapper">
    <!-- Left Panel - Branding -->
    <div class="auth-branding">
        <div class="branding-content">
            <div class="brand-logo">
                <i class="fas fa-gem"></i>
            </div>
            <h1 class="brand-name">Smart Jewelry</h1>
            <p class="brand-tagline">Trang sức & Đá quý cao cấp</p>
            
            <ul class="brand-features">
                <li>
                    <i class="fas fa-shield-alt"></i>
                    <span>Sử dụng mật khẩu mạnh và an toàn</span>
                </li>
                <li>
                    <i class="fas fa-text-width"></i>
                    <span>Tối thiểu 6 ký tự</span>
                </li>
                <li>
                    <i class="fas fa-asterisk"></i>
                    <span>Kết hợp chữ, số và ký tự đặc biệt</span>
                </li>
                <li>
                    <i class="fas fa-user-secret"></i>
                    <span>Không chia sẻ mật khẩu với ai</span>
                </li>
            </ul>
        </div>
    </div>

    <!-- Right Panel - Form -->
    <div class="auth-form-panel">
        <div class="auth-form-container">
            @if (Model.ResetSuccess)
            {
                <!-- Success State -->
                <div class="auth-header">
                    <div class="success-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <h1>Thành công!</h1>
                    <p>Mật khẩu của bạn đã được đặt lại thành công</p>
                </div>

                <a href="/Auth/Login" class="btn btn-primary btn-block">
                    <i class="fas fa-sign-in-alt"></i>
                    Đăng nhập ngay
                </a>
            }
            else if (!Model.TokenValid)
            {
                <!-- Invalid Token State -->
                <div class="auth-header">
                    <div class="success-icon error-icon">
                        <i class="fas fa-times"></i>
                    </div>
                    <h1>Link không hợp lệ</h1>
                    <p>Link đặt lại mật khẩu đã hết hạn hoặc không hợp lệ</p>
                </div>

                <div class="alert alert-error">
                    <i class="fas fa-exclamation-circle"></i>
                    <span>Vui lòng yêu cầu link đặt lại mật khẩu mới.</span>
                </div>

                <a href="/Auth/ForgotPassword" class="btn btn-primary btn-block">
                    <i class="fas fa-redo"></i>
                    Yêu cầu link mới
                </a>
            }
            else
            {
                <!-- Form State -->
                <a href="/Auth/Login" class="back-link">
                    <i class="fas fa-arrow-left"></i>
                    Quay lại đăng nhập
                </a>

                <div class="auth-header">
                    <h1>Đặt lại mật khẩu</h1>
                    <p>Tạo mật khẩu mới cho tài khoản của bạn</p>
                </div>

                @if (!string.IsNullOrEmpty(Model.ErrorMessage))
                {
                    <div class="alert alert-error">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>@Model.ErrorMessage</span>
                    </div>
                }

                <form method="post" class="auth-form">
                    @Html.AntiForgeryToken()
                    <input type="hidden" asp-for="Token" />
                    
                    <div class="form-group">
                        <label asp-for="Input.NewPassword">Mật khẩu mới <span class="required">*</span></label>
                        <div class="input-wrapper">
                            <i class="fas fa-lock"></i>
                            <input type="password" 
                                   asp-for="Input.NewPassword"
                                   placeholder="Tối thiểu 6 ký tự"
                                   autocomplete="new-password" />
                            <button type="button" class="password-toggle" tabindex="-1" onclick="togglePassword(this)">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <span asp-validation-for="Input.NewPassword" class="field-validation-error"></span>
                    </div>

                    <div class="form-group">
                        <label asp-for="Input.ConfirmPassword">Xác nhận mật khẩu <span class="required">*</span></label>
                        <div class="input-wrapper">
                            <i class="fas fa-lock"></i>
                            <input type="password" 
                                   asp-for="Input.ConfirmPassword"
                                   placeholder="Nhập lại mật khẩu mới"
                                   autocomplete="new-password" />
                            <button type="button" class="password-toggle" tabindex="-1" onclick="togglePassword(this)">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <span asp-validation-for="Input.ConfirmPassword" class="field-validation-error"></span>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fas fa-save"></i>
                        Đặt lại mật khẩu
                    </button>
                </form>
            }

            <div class="auth-footer">
                <p>Cần hỗ trợ? <a href="/contact">Liên hệ chúng tôi</a></p>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation-unobtrusive@3.2.12/dist/jquery.validate.unobtrusive.min.js"></script>
<script>
    function togglePassword(btn) {
        const input = btn.parentElement.querySelector('input');
        const icon = btn.querySelector('i');
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }
</script>
</body>
</html>
